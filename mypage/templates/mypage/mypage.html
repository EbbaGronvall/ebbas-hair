{% extends "base.html" %} 
{% block content %}
{% load static %}

<h3>Update Email</h3>
<form method="post">
    <p><strong>Current email: </strong>{{ user.email }}</p>
    {% csrf_token %}
    {{ email_form.as_p }}
    <button type="submit">Update Email</button>
</form>

<h3>Your Bookings</h3>
{% for booking in bookings %}
    <form method="post" action="{% url 'mypage' %}">
        {% csrf_token %}
        <input type="hidden" name="booking_id" value="{{ booking.id }}">
        <div>
            <p><strong>Current Booking:</strong> {{ booking.day }} at {{ booking.time }}</p>
            <label for="new_day">Select new day:</label>
            <input type="date" name="new_day" id="new_day" value="{{ booking.day|date:'Y-m-d' }}" min="{{ date_today|date:'Y-m-d' }}">
            <br>
            <label for="new_time">Select new time:</label>
            <select name="new_time" id="new_time">
                {% for time_value, time_display in time_choices %}
                    <option value="{{ time_value }}" {% if time_value == booking.time %}selected{% endif %}>{{ time_display }}</option>
                {% endfor %}
            </select>
            <div>
            <button type="submit" name="update_booking">Update Booking</button>
            <button type="submit" name="delete_booking">Delete Booking</button>
        </div>
        </div>
    </form>
{% endfor %}

{% endblock %}